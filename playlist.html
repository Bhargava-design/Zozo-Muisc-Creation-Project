<!DOCTYPE html>
<html>
<head>
    <title>My Music Playlist</title>
</head>
<body>
    
    <div id="playlist"></div>

    <div class="works" id="album">
		<div class="container">
			<h3 class="tittle_w3ls cen">Latest Albums</h3>
			<div class="inner_sec_info_agile-w3ls">
				<div class="column add-bottom">
					<div id="mainwrap">
						<div id="nowPlay">
							<span class="left" id="npAction">Paused...</span>
							<span class="right" id="npTitle"></span>
						</div>
						<div id="audiowrap">
							<div id="audio0">
								<audio preload id="audio1" controls="controls">Your browser does not support HTML5 Audio!</audio>
							</div>
							<div id="tracks">
								<a id="btnPrev">&larr;</a>
								<a id="btnNext">&rarr;</a>
							</div>
						</div>
						<div id="plwrap">
							<ul id="plList"></ul>
						</div>
						<div>
							<a href="playlist.html"> Play more....</a>
					</div>
				</div>
			</div>

		</div>
	</div>

    <!-- Include the Azure Blob Storage JavaScript SDK -->
    <script src="https://js.dev.azure.com/azure-sdk/jslib/azure-storage-blob/12.10.0/dist/azure-storage-blob.js"></script>
    <script>
        // Your connection string and container name
        const connectionString = "DefaultEndpointsProtocol=https;AccountName=musicsblock;AccountKey=jAQWo4ZwwDfbaALlbGWKoHVWmG1pPkMiefyQBLUO7BKBDvzJ4jWDRU3+S0Kf1900q4v7kI/Vph6f+AStcD+WVw==;EndpointSuffix=core.windows.net";
        const containerName = "englishmusic";

        // Create a new BlobServiceClient using the connection string
        const blobServiceClient = new Azure.Storage.Blob.BlobServiceClient(connectionString);

        // Get a reference to the container
        const containerClient = blobServiceClient.getContainerClient(containerName);

        // Function to display the music playlist
        async function displayPlaylist() {
            try {
                // Get a list of all blobs in the container
                const blobList = containerClient.listBlobsFlat();

                // HTML template to display each music entry
                const musicEntryTemplate = (name, url) => `<p><a href="#" onclick="playMusic('${url}')">${name}</a></p>`;

                // Display each music entry in the "playlist" div
                const playlistDiv = document.getElementById("playlist");
                playlistDiv.innerHTML = ""; // Clear previous entries (if any)
                for await (const blob of blobList) {
                    const name = blob.name;
                    const url = blobServiceClient.getBlobUrl(containerName, name);
                    playlistDiv.innerHTML += musicEntryTemplate(name, url);
                }
            } catch (error) {
                console.error("Error displaying playlist:", error);
            }
        }

        // Call the function to display the music playlist when the page loads
        window.addEventListener("load", displayPlaylist);

        // Function to access and play the music when the link is clicked
        function playMusic(url) {
            // Add your music playing logic here
            console.log("Playing music from:", url);
            // Implement the logic to play the music, e.g., use an audio player or HTML5 audio tag.
        }
    </script>
</body>
</html>
